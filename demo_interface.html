<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADA Compliance Checker - Demo Interface</title>
    <style>
        /* Accessible, high-contrast design for government use */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #1a1a1a;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #003366;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        /* Upload Area */
        .upload-section {
            border: 3px dashed #ccc;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .upload-section:hover,
        .upload-section.dragover {
            border-color: #003366;
            background: #f0f8ff;
        }

        .upload-section input[type="file"] {
            margin: 20px 0;
        }

        /* Buttons */
        button {
            background: #003366;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }

        button:hover {
            background: #005599;
        }

        button:focus {
            outline: 3px solid #005fcc;
            outline-offset: 2px;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Loading Spinner */
        .spinner {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #003366;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
        }

        .status-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .status-badge.compliant {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .status-badge.non-compliant {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        /* Issue Cards */
        .issue {
            background: white;
            border-left: 5px solid #ccc;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .issue.critical {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .issue.error {
            border-left-color: #fd7e14;
            background: #fff8f5;
        }

        .issue.warning {
            border-left-color: #ffc107;
            background: #fffbf0;
        }

        .issue.info {
            border-left-color: #17a2b8;
            background: #f0f9ff;
        }

        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .severity-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            color: white;
        }

        .severity-badge.critical { background: #dc3545; }
        .severity-badge.error { background: #fd7e14; }
        .severity-badge.warning { background: #ffc107; color: #000; }
        .severity-badge.info { background: #17a2b8; }

        .wcag-link {
            color: #003366;
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
        }

        .wcag-link:hover {
            text-decoration: underline;
        }

        .issue-description {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1a1a1a;
        }

        .issue-location {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .remediation {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            display: none;
        }

        .remediation.show {
            display: block;
        }

        .remediation h4 {
            color: #003366;
            margin-bottom: 10px;
        }

        .remediation pre {
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.6;
        }

        .toggle-remediation {
            background: transparent;
            color: #003366;
            border: 1px solid #003366;
            padding: 8px 16px;
            font-size: 14px;
            margin-top: 10px;
        }

        .toggle-remediation:hover {
            background: #003366;
            color: white;
        }

        /* Summary Section */
        .summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .summary h2 {
            color: #003366;
            margin-bottom: 10px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-box {
            background: white;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #003366;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        /* Screen Reader Only (for accessibility) */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ADA Compliance Checker</h1>
        <p class="subtitle">Check if your documents meet WCAG Level AA accessibility standards</p>

        <!-- Upload Section -->
        <div class="upload-section" id="uploadArea">
            <div>
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
            </div>
            <h3>Upload a Document</h3>
            <p>Supported formats: PDF, Word (.docx), Excel (.xlsx)</p>
            
            <input type="file" id="fileInput" accept=".pdf,.docx,.xlsx" />
            
            <div style="margin-top: 20px;">
                <button id="checkBtn" disabled onclick="checkAccessibility()">
                    Check Accessibility
                </button>
            </div>

            <div class="spinner" id="spinner"></div>
        </div>

        <!-- Results Section -->
        <div class="results" id="results" role="region" aria-live="polite">
            <!-- Summary -->
            <div class="summary" id="summary"></div>

            <!-- Issues List -->
            <div id="issuesList"></div>
        </div>
    </div>

    <script>
        // =================================================================
        // Global Variables
        // =================================================================
        let selectedFile = null;
        const API_BASE_URL = 'http://0.0.0.0:8000';

        // =================================================================
        // File Selection Handling
        // =================================================================
        const fileInput = document.getElementById('fileInput');
        const checkBtn = document.getElementById('checkBtn');
        const uploadArea = document.getElementById('uploadArea');

        fileInput.addEventListener('change', (e) => {
            selectedFile = e.target.files[0];
            checkBtn.disabled = !selectedFile;
        });

        // Drag and drop support
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                selectedFile = files[0];
                checkBtn.disabled = false;
            }
        });

        // =================================================================
        // Check Accessibility Function
        // =================================================================
        async function checkAccessibility() {
            if (!selectedFile) return;

            // Show loading state
            document.getElementById('spinner').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            checkBtn.disabled = true;

            // Prepare form data
            const formData = new FormData();
            formData.append('file', selectedFile);

            try {
                // Call the API
                const response = await fetch(`${API_BASE_URL}/check-accessibility`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                
                // Display results
                displayResults(data.report);

            } catch (error) {
                console.error('Error checking accessibility:', error);
                alert('Error checking file. Make sure the API server is running on localhost:8000');
            } finally {
                // Hide loading state
                document.getElementById('spinner').style.display = 'none';
                checkBtn.disabled = false;
            }
        }

        // =================================================================
        // Display Results
        // =================================================================
        function displayResults(report) {
            const resultsDiv = document.getElementById('results');
            const summaryDiv = document.getElementById('summary');
            const issuesListDiv = document.getElementById('issuesList');

            // Show results section
            resultsDiv.style.display = 'block';

            // Build summary
            const statusBadge = report.is_compliant 
                ? '<div class="status-badge compliant">‚úÖ WCAG AA Compliant</div>'
                : '<div class="status-badge non-compliant">‚ùå Not Compliant</div>';

            summaryDiv.innerHTML = `
                ${statusBadge}
                <h2>${report.file_name}</h2>
                <p>${report.summary}</p>
                
                <div class="stats">
                    <div class="stat-box">
                        <div class="stat-number">${report.total_issues}</div>
                        <div class="stat-label">Total Issues</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">${report.critical_issues}</div>
                        <div class="stat-label">Critical</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">${report.error_issues}</div>
                        <div class="stat-label">Errors</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">${report.warning_issues}</div>
                        <div class="stat-label">Warnings</div>
                    </div>
                </div>
            `;

            // Build issues list
            if (report.issues && report.issues.length > 0) {
                issuesListDiv.innerHTML = '<h2>Issues Found</h2>' + 
                    report.issues.map((issue, index) => createIssueCard(issue, index)).join('');
            } else {
                issuesListDiv.innerHTML = '<p>No issues found! This document meets WCAG AA standards.</p>';
            }
        }

        // =================================================================
        // Create Issue Card
        // =================================================================
        function createIssueCard(issue, index) {
            const wcagUrl = `https://www.w3.org/WAI/WCAG21/Understanding/${issue.wcag_criterion.replace('.', '')}.html`;
            
            return `
                <div class="issue ${issue.level}">
                    <div class="issue-header">
                        <span class="severity-badge ${issue.level}">${issue.level}</span>
                        <a href="${wcagUrl}" target="_blank" class="wcag-link">
                            WCAG ${issue.wcag_criterion}
                        </a>
                    </div>
                    
                    <div class="issue-description">${issue.description}</div>
                    
                    ${issue.location ? `<div class="issue-location">üìç ${issue.location}</div>` : ''}
                    
                    <button class="toggle-remediation" onclick="toggleRemediation(${index})">
                        Show Fix Instructions
                    </button>
                    
                    <div class="remediation" id="remediation-${index}">
                        <h4>How to Fix:</h4>
                        <pre>${issue.remediation}</pre>
                    </div>
                </div>
            `;
        }

        // =================================================================
        // Toggle Remediation Details
        // =================================================================
        function toggleRemediation(index) {
            const remediationDiv = document.getElementById(`remediation-${index}`);
            const button = event.target;
            
            if (remediationDiv.classList.contains('show')) {
                remediationDiv.classList.remove('show');
                button.textContent = 'Show Fix Instructions';
            } else {
                remediationDiv.classList.add('show');
                button.textContent = 'Hide Fix Instructions';
            }
        }
    </script>

    <!-- Screen reader announcement for status changes -->
    <div role="status" aria-live="polite" class="sr-only" id="srAnnouncement"></div>
</body>
</html>
